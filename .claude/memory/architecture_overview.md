# ZenSpace æ™ºèƒ½è‡ªä¹ å®¤ - æ¶æ„æ€»è§ˆ (Architecture Overview)

> **æ–‡æ¡£ç±»å‹**: ç³»ç»Ÿæ¶æ„è®¾è®¡
> **ç»´æŠ¤è€…**: Architect
> **æ›´æ–°æ—¥æœŸ**: 2026-01-24
> **çŠ¶æ€**: âœ… å½“å‰æœ‰æ•ˆ

---

## ğŸ“ æ¶æ„åŸåˆ™ (Architecture Principles)

### æ ¸å¿ƒå“²å­¦

```
é€»è¾‘ä¸è§†å›¾åˆ†ç¦» â†’ å¹³å°æ— å…³æ€§ â†’ æµ‹è¯•é©±åŠ¨å¼€å‘ â†’ å¥‘çº¦å¼åä½œ
```

### äº”å¤§æ”¯æŸ±

| æ”¯æŸ± | åŸåˆ™ | æ”¶ç›Š |
|:-----|:-----|:-----|
| **1. æ¥å£å³å›´æ ** | Core å±‚ 100% çº¯ TypeScriptï¼Œé›¶å¹³å° API | è·¨å¹³å°å¤ç”¨ã€å•å…ƒæµ‹è¯•éš”ç¦» |
| **2. Monorepo éš”ç¦»** | Packages é—´é€šè¿‡æ¥å£é€šä¿¡ï¼Œç¦æ­¢ç›´æ¥ä¾èµ–å®ç° | æ¨¡å—ç‹¬ç«‹æ¼”è¿›ã€ä¾èµ–æ¸…æ™° |
| **3. TDD å¼ºåˆ¶å¾ªç¯** | å…ˆå†™æµ‹è¯• â†’ å®ç°é€»è¾‘ â†’ é‡æ„ä¼˜åŒ– | é«˜è´¨é‡ä»£ç ã€å›å½’ä¿æŠ¤ |
| **4. å¥‘çº¦å¼å¼€å‘** | PRD â†’ Design Spec â†’ Ticket â†’ Implementation | éœ€æ±‚å¯è¿½æº¯ã€è´£ä»»æ˜ç¡® |
| **5. é€‚é…å™¨æ³¨å…¥** | å¹³å° API é€šè¿‡ Adapter æ¥å£æŠ½è±¡ | ä¾èµ–åè½¬ã€Mock å‹å¥½ |

---

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„ (System Architecture)

### 1ï¸âƒ£ æ•´ä½“æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         ZenSpace ç³»ç»Ÿæ¶æ„                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          ç”¨æˆ·ç«¯ (Clients)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å¾®ä¿¡å°ç¨‹åº  â”‚  H5 ç½‘é¡µç‰ˆ   â”‚   æ”¯ä»˜å®å°ç¨‹åº â”‚   App (æœªæ¥)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     å‰ç«¯ Monorepo (Frontend)                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚              Packages/UI (è§†å›¾å±‚)                       â”‚    â”‚
â”‚  â”‚  - Pages (é¡µé¢): é¦–é¡µã€é¢„çº¦ã€é€‰åº§ã€ä¸ªäººä¸­å¿ƒ           â”‚    â”‚
â”‚  â”‚  - Components (ç»„ä»¶): ZoneCard, SeatMap, StatsCard    â”‚    â”‚
â”‚  â”‚  - Adapters Implementation (é€‚é…å™¨å®ç°)                â”‚    â”‚
â”‚  â”‚  - UniApp é¡µé¢é…ç½® (pages.json)                        â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                             â†‘ è°ƒç”¨                              â”‚
â”‚                             â”‚                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚            Packages/Core (ä¸šåŠ¡é€»è¾‘å±‚)                   â”‚    â”‚
â”‚  â”‚                                                          â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚    â”‚
â”‚  â”‚  â”‚  Composables (ä¸šåŠ¡ Hook)                    â”‚       â”‚    â”‚
â”‚  â”‚  â”‚  - useAuth: è®¤è¯é€»è¾‘                        â”‚       â”‚    â”‚
â”‚  â”‚  â”‚  - useBooking: é¢„çº¦é€»è¾‘                     â”‚       â”‚    â”‚
â”‚  â”‚  â”‚  - useSeat: åº§ä½æŸ¥è¯¢                        â”‚       â”‚    â”‚
â”‚  â”‚  â”‚  - useZone: åŒºåŸŸç®¡ç†                        â”‚       â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚    â”‚
â”‚  â”‚                                                          â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚    â”‚
â”‚  â”‚  â”‚  Stores (Pinia çŠ¶æ€ç®¡ç†)                    â”‚       â”‚    â”‚
â”‚  â”‚  â”‚  - user.ts: ç”¨æˆ·çŠ¶æ€                        â”‚       â”‚    â”‚
â”‚  â”‚  â”‚  - booking.ts: é¢„çº¦çŠ¶æ€                     â”‚       â”‚    â”‚
â”‚  â”‚  â”‚  - seat.ts: åº§ä½çŠ¶æ€                        â”‚       â”‚    â”‚
â”‚  â”‚  â”‚  - zone.ts: åŒºåŸŸçŠ¶æ€                        â”‚       â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚    â”‚
â”‚  â”‚                                                          â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚    â”‚
â”‚  â”‚  â”‚  Adapters (å¹³å°æ¥å£æŠ½è±¡)                    â”‚       â”‚    â”‚
â”‚  â”‚  â”‚  - IHttp: HTTP è¯·æ±‚æ¥å£                     â”‚       â”‚    â”‚
â”‚  â”‚  â”‚  - IStorage: æœ¬åœ°å­˜å‚¨æ¥å£                   â”‚       â”‚    â”‚
â”‚  â”‚  â”‚  - ILocation: åœ°ç†ä½ç½®æ¥å£                  â”‚       â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚    â”‚
â”‚  â”‚                                                          â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚    â”‚
â”‚  â”‚  â”‚  API (æ¥å£è°ƒç”¨å°è£…)                         â”‚       â”‚    â”‚
â”‚  â”‚  â”‚  - auth.ts: è®¤è¯ API                        â”‚       â”‚    â”‚
â”‚  â”‚  â”‚  - booking.ts: é¢„çº¦ API                     â”‚       â”‚    â”‚
â”‚  â”‚  â”‚  - seat.ts: åº§ä½ API                        â”‚       â”‚    â”‚
â”‚  â”‚  â”‚  - zone.ts: åŒºåŸŸ API                        â”‚       â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚    â”‚
â”‚  â”‚                                                          â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚    â”‚
â”‚  â”‚  â”‚  Types (ç±»å‹å®šä¹‰)                           â”‚       â”‚    â”‚
â”‚  â”‚  â”‚  - user.ts, booking.ts, seat.ts, zone.ts   â”‚       â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚    â”‚
â”‚  â”‚                                                          â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚    â”‚
â”‚  â”‚  â”‚  Utils (å·¥å…·å‡½æ•°)                           â”‚       â”‚    â”‚
â”‚  â”‚  â”‚  - date.ts, format.ts, validate.ts          â”‚       â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚    â”‚
â”‚  â”‚                                                          â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â†“ HTTP/WebSocket
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      åç«¯æœåŠ¡ (Backend)                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚              NestJS åº”ç”¨å±‚                              â”‚    â”‚
â”‚  â”‚  - Controllers: è·¯ç”±æ§åˆ¶å™¨                             â”‚    â”‚
â”‚  â”‚  - Services: ä¸šåŠ¡æœåŠ¡                                  â”‚    â”‚
â”‚  â”‚  - Guards: æƒé™å®ˆå« (JWT)                              â”‚    â”‚
â”‚  â”‚  - Interceptors: æ‹¦æˆªå™¨                                â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                             â†“                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚              Prisma ORM å±‚                              â”‚    â”‚
â”‚  â”‚  - Schema: æ•°æ®æ¨¡å‹å®šä¹‰                                â”‚    â”‚
â”‚  â”‚  - Client: æ•°æ®åº“å®¢æˆ·ç«¯                                â”‚    â”‚
â”‚  â”‚  - Migrations: æ•°æ®åº“è¿ç§»                              â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                             â†“                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚           PostgreSQL + Redis                            â”‚    â”‚
â”‚  â”‚  - PostgreSQL: ä¸»æ•°æ®åº“                                â”‚    â”‚
â”‚  â”‚  - Redis: ç¼“å­˜ + Session + æ¶ˆæ¯é˜Ÿåˆ—                    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2ï¸âƒ£ æ ¸å¿ƒæ•°æ®æµ

#### ç”¨æˆ·é¢„çº¦æµç¨‹æ•°æ®æµ

```
ç”¨æˆ·æ“ä½œ (UI Layer)
    â†“
è°ƒç”¨ useBooking().createBooking()  â† Composable (Core Layer)
    â†“
bookingStore.setLoading(true)      â† Pinia Store (Core Layer)
    â†“
bookingApi.create(data)            â† API Module (Core Layer)
    â†“
http.request({ ... })              â† Adapter Interface (Core Layer)
    â†“
[è·¨è¶Šè¾¹ç•Œ - é€‚é…å™¨å®ç°åœ¨ UI Layer]
    â†“
uni.request({ ... })               â† UniApp API (UI Layer)
    â†“
HTTP POST /api/bookings            â†’ Backend API
    â†“
BookingController.create()         â† NestJS Controller
    â†“
BookingService.create()            â† Business Logic
    â†“
prisma.booking.create()            â† Prisma ORM
    â†“
PostgreSQL Database                â† æ•°æ®æŒä¹…åŒ–
    â†“
Response JSON                      â†’ è¿”å›ç»“æœ
    â†“
bookingStore.addBooking(result)    â† æ›´æ–°çŠ¶æ€
    â†“
UI è‡ªåŠ¨å“åº”å¼æ›´æ–°                   â† Vue 3 å“åº”å¼ç³»ç»Ÿ
```

---

## ğŸ”’ æ¥å£å›´æ è§„åˆ™ (Interface Fence Rule)

### è§„åˆ™å®šä¹‰

**Core å±‚ç¦æ­¢åŒº (Forbidden Zone)**:

```typescript
// âŒ ä»¥ä¸‹ä»£ç åœ¨ packages/core/src/ ä¸­ç»å¯¹ç¦æ­¢

// 1. UniApp API
uni.request()
uni.getStorage()
uni.navigateTo()

// 2. å¾®ä¿¡å°ç¨‹åº API
wx.login()
wx.getUserInfo()

// 3. æµè§ˆå™¨ API
window.location
navigator.geolocation
document.querySelector()

// 4. ä»»ä½•å¹³å°ç‰¹å®š API
my.xxx  // æ”¯ä»˜å®
swan.xxx  // ç™¾åº¦
tt.xxx  // å­—èŠ‚è·³åŠ¨
```

### æ­£ç¡®å®è·µ

**åœ¨ Core å±‚å®šä¹‰æ¥å£**:

```typescript
// packages/core/src/adapters/IHttp.ts
export interface IHttp {
  request<T>(config: HttpConfig): Promise<HttpResponse<T>>
}

// packages/core/src/composables/useAuth.ts
import type { IHttp } from '@/adapters/IHttp'

export function useAuth(http: IHttp) {
  const login = async (phone: string, code: string) => {
    // ä½¿ç”¨æ³¨å…¥çš„ http æ¥å£ï¼Œè€Œéç›´æ¥è°ƒç”¨ uni.request
    const res = await http.request({
      url: '/api/auth/login',
      method: 'POST',
      data: { phone, code }
    })
    return res.data
  }

  return { login }
}
```

**åœ¨ UI å±‚å®ç°é€‚é…å™¨**:

```typescript
// packages/ui/src/utils/adapters.ts
import type { IHttp } from '@zenspace/core/adapters/IHttp'

export const httpAdapter: IHttp = {
  request: async (config) => {
    // è¿™é‡Œæ‰ä½¿ç”¨å¹³å° API
    const [error, res] = await uni.request({
      url: config.url,
      method: config.method,
      data: config.data
    })

    if (error) throw error
    return res
  }
}
```

**åœ¨ UI å±‚ç»„è£…ä½¿ç”¨**:

```typescript
// packages/ui/src/pages/login/index.vue
<script setup lang="ts">
import { useAuth } from '@zenspace/core/composables/useAuth'
import { httpAdapter } from '@/utils/adapters'

// æ³¨å…¥é€‚é…å™¨
const { login } = useAuth(httpAdapter)

const handleLogin = async () => {
  await login('13800138000', '123456')
}
</script>
```

### å›´æ ä¿æŠ¤æœºåˆ¶

1. **é™æ€æ£€æŸ¥** (Pre-commit Hook):
   - æ‰«æ `packages/core/src/` ç›®å½•
   - æ£€æµ‹ `uni.`, `wx.`, `window.` ç­‰å…³é”®å­—
   - å‘ç°è¿è§„ç«‹å³é˜»æ­¢æäº¤

2. **CI æ£€æŸ¥** (GitHub Actions):
   - è¿è¡Œé›¶æ±¡æŸ“æ£€æŸ¥è„šæœ¬
   - PR æ— æ³•åˆå¹¶ç›´åˆ°é—®é¢˜ä¿®å¤

3. **äººå·¥å®¡æŸ¥** (Architect Code Review):
   - Architect å®šæœŸå®¡æŸ¥ Core å±‚ä»£ç 
   - ç¡®ä¿æ¶æ„åŸåˆ™å¾—åˆ°éµå®ˆ

---

## ğŸ§ª TDD å¼€å‘å¾ªç¯ (TDD Cycle)

### æ ‡å‡†æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       TDD ä¸‰è‰²å¾ªç¯                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ”´ RED (å¤±è´¥æµ‹è¯•)
    â†“
    ç¼–å†™æµ‹è¯•ç”¨ä¾‹ï¼Œè¿è¡Œæµ‹è¯•ï¼Œé¢„æœŸå¤±è´¥
    â†“
    ç¤ºä¾‹: it('åº”è¯¥èƒ½å¤Ÿç™»å½•', async () => {
            const result = await login('phone', 'code')
            expect(result.success).toBe(true)  // âŒ å‡½æ•°è¿˜ä¸å­˜åœ¨
          })
    â†“
ğŸŸ¢ GREEN (æœ€å°å®ç°)
    â†“
    ç¼–å†™æœ€å°ä»£ç ä½¿æµ‹è¯•é€šè¿‡
    â†“
    ç¤ºä¾‹: const login = async () => ({ success: true })  // âœ… é€šè¿‡äº†
    â†“
ğŸ”µ REFACTOR (é‡æ„ä¼˜åŒ–)
    â†“
    åœ¨ä¿æŒæµ‹è¯•é€šè¿‡çš„å‰æä¸‹ä¼˜åŒ–ä»£ç 
    â†“
    ç¤ºä¾‹: æ·»åŠ çœŸå® API è°ƒç”¨ã€é”™è¯¯å¤„ç†ã€ç±»å‹å®‰å…¨
    â†“
    â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    â†“                                    â†‘
    ç»§ç»­ä¸‹ä¸€ä¸ªåŠŸèƒ½ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æµ‹è¯•ç»„ç»‡ç»“æ„

```
packages/core/tests/
â”œâ”€â”€ composables/
â”‚   â”œâ”€â”€ useAuth.spec.ts          # âœ… 14 ä¸ªæµ‹è¯•ç”¨ä¾‹
â”‚   â”œâ”€â”€ useBooking.spec.ts       # âœ… 17 ä¸ªæµ‹è¯•ç”¨ä¾‹
â”‚   â”œâ”€â”€ useSeat.spec.ts          # âœ… 18 ä¸ªæµ‹è¯•ç”¨ä¾‹
â”‚   â””â”€â”€ useZone.spec.ts          # âœ… 15 ä¸ªæµ‹è¯•ç”¨ä¾‹
â”œâ”€â”€ stores/
â”‚   â”œâ”€â”€ user.spec.ts             # ğŸš§ å¾…è¡¥å……
â”‚   â”œâ”€â”€ booking.spec.ts          # ğŸš§ å¾…è¡¥å……
â”‚   â””â”€â”€ ...
â”œâ”€â”€ utils/
â”‚   â””â”€â”€ ...
â””â”€â”€ vitest.config.ts
```

### æµ‹è¯•è¦†ç›–ç‡è¦æ±‚

| ä»£ç ç±»å‹ | è¦†ç›–ç‡ç›®æ ‡ | è¯´æ˜ |
|:--------|:----------|:-----|
| Composables | â‰¥ 80% | æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ï¼Œå¿…é¡»é«˜è¦†ç›– |
| Stores | â‰¥ 70% | çŠ¶æ€ç®¡ç†é€»è¾‘ |
| Utils | â‰¥ 70% | å·¥å…·å‡½æ•° |
| API Modules | â‰¥ 60% | API å°è£…å±‚ |
| Types | 0% | ç±»å‹å®šä¹‰æ— éœ€æµ‹è¯• |

---

## ğŸ“¦ Monorepo åŒ…ç®¡ç† (Package Management)

### åŒ…ç»“æ„

```
frontend/
â”œâ”€â”€ package.json              # Monorepo æ ¹é…ç½®
â”œâ”€â”€ pnpm-workspace.yaml       # pnpm workspace é…ç½®
â””â”€â”€ packages/
    â”œâ”€â”€ core/                 # ğŸ“¦ @zenspace/core
    â”‚   â”œâ”€â”€ package.json
    â”‚   â”œâ”€â”€ src/
    â”‚   â”œâ”€â”€ tests/
    â”‚   â””â”€â”€ tsconfig.json
    â”‚
    â””â”€â”€ ui/                   # ğŸ“¦ @zenspace/ui
        â”œâ”€â”€ package.json
        â”œâ”€â”€ src/
        â”œâ”€â”€ pages.json
        â””â”€â”€ vite.config.ts
```

### ä¾èµ–å…³ç³»

```
@zenspace/ui
    â†“ (depends on)
@zenspace/core
    â†“ (no dependencies)
    çº¯ TypeScript ç¯å¢ƒ
```

**è§„åˆ™**:
- âœ… UI å¯ä»¥ä¾èµ– Core
- âŒ Core **ç»å¯¹ä¸èƒ½**ä¾èµ– UI
- âŒ Core **ç»å¯¹ä¸èƒ½**ä¾èµ– UniApp

### åŒ…é—´å¼•ç”¨

```typescript
// packages/ui/src/pages/index/index.vue

// âœ… æ­£ç¡® - é€šè¿‡åŒ…åå¼•ç”¨
import { useAuth } from '@zenspace/core/composables/useAuth'
import type { User } from '@zenspace/core/types/user'

// âŒ é”™è¯¯ - ä¸è¦ä½¿ç”¨ç›¸å¯¹è·¯å¾„
import { useAuth } from '../../../core/src/composables/useAuth'
```

---

## ğŸ¯ çŠ¶æ€ç®¡ç†ç­–ç•¥ (State Management)

### Pinia Store è®¾è®¡

```typescript
// packages/core/src/stores/user.ts
import { defineStore } from 'pinia'
import type { User } from '@/types/user'

export const useUserStore = defineStore('user', () => {
  // State
  const user = ref<User | null>(null)
  const token = ref<string>('')
  const isLoggedIn = computed(() => !!token.value)

  // Actions
  const setUser = (newUser: User) => {
    user.value = newUser
  }

  const setToken = (newToken: string) => {
    token.value = newToken
  }

  const logout = () => {
    user.value = null
    token.value = ''
  }

  return {
    // State
    user,
    token,
    isLoggedIn,

    // Actions
    setUser,
    setToken,
    logout
  }
})
```

### Store æ¨¡å—åˆ’åˆ†

| Store æ¨¡å— | èŒè´£ | çŠ¶æ€ç¤ºä¾‹ |
|:----------|:-----|:--------|
| `user` | ç”¨æˆ·è®¤è¯ä¸ä¸ªäººä¿¡æ¯ | `user`, `token`, `isLoggedIn` |
| `booking` | é¢„çº¦çŠ¶æ€ç®¡ç† | `bookings`, `currentBooking`, `loading` |
| `seat` | åº§ä½çŠ¶æ€ | `seats`, `selectedSeat` |
| `zone` | åŒºåŸŸçŠ¶æ€ | `zones`, `currentZone` |
| `system` | ç³»ç»Ÿé…ç½® | `appConfig`, `theme`, `locale` |

### æŒä¹…åŒ–ç­–ç•¥

```typescript
// åœ¨ UI å±‚é…ç½®æŒä¹…åŒ–
// packages/ui/src/main.ts
import { createPinia } from 'pinia'
import { createPersistedState } from 'pinia-plugin-persistedstate'

const pinia = createPinia()
pinia.use(createPersistedState({
  storage: {
    getItem: (key) => uni.getStorageSync(key),
    setItem: (key, value) => uni.setStorageSync(key, value)
  }
}))
```

---

## ğŸ”Œ é€‚é…å™¨æ¨¡å¼ (Adapter Pattern)

### é€‚é…å™¨æ¥å£æ¸…å•

| æ¥å£å | æ–‡ä»¶è·¯å¾„ | èŒè´£ | å¹³å°å®ç° |
|:------|:--------|:-----|:--------|
| `IHttp` | `adapters/IHttp.ts` | HTTP è¯·æ±‚ | `uni.request()` |
| `IStorage` | `adapters/IStorage.ts` | æœ¬åœ°å­˜å‚¨ | `uni.getStorage()` |
| `ILocation` | `adapters/ILocation.ts` | åœ°ç†ä½ç½® | `uni.getLocation()` |
| `IRouter` | `adapters/IRouter.ts` | è·¯ç”±å¯¼èˆª | `uni.navigateTo()` |
| `IWebSocket` | `adapters/IWebSocket.ts` | WebSocket | `uni.connectSocket()` |

### é€‚é…å™¨æ¥å£ç¤ºä¾‹

```typescript
// packages/core/src/adapters/IStorage.ts
export interface IStorage {
  get<T>(key: string): Promise<T | null>
  set<T>(key: string, value: T): Promise<void>
  remove(key: string): Promise<void>
  clear(): Promise<void>
}

// packages/ui/src/utils/adapters.ts
import type { IStorage } from '@zenspace/core/adapters/IStorage'

export const storageAdapter: IStorage = {
  async get<T>(key: string): Promise<T | null> {
    try {
      const res = await uni.getStorage({ key })
      return res.data as T
    } catch {
      return null
    }
  },

  async set<T>(key: string, value: T): Promise<void> {
    await uni.setStorage({ key, data: value })
  },

  async remove(key: string): Promise<void> {
    await uni.removeStorage({ key })
  },

  async clear(): Promise<void> {
    await uni.clearStorage()
  }
}
```

---

## ğŸ“¡ API è°ƒç”¨æ¶æ„ (API Architecture)

### API æ¨¡å—è®¾è®¡

```typescript
// packages/core/src/api/auth.ts
import type { IHttp } from '@/adapters/IHttp'
import type { LoginParams, LoginResponse } from '@/types/auth'

export const createAuthApi = (http: IHttp) => {
  return {
    login: async (params: LoginParams): Promise<LoginResponse> => {
      const res = await http.request<LoginResponse>({
        url: '/api/auth/login',
        method: 'POST',
        data: params
      })
      return res.data
    },

    logout: async (): Promise<void> => {
      await http.request({
        url: '/api/auth/logout',
        method: 'POST'
      })
    },

    refreshToken: async (refreshToken: string): Promise<{ token: string }> => {
      const res = await http.request({
        url: '/api/auth/refresh',
        method: 'POST',
        data: { refreshToken }
      })
      return res.data
    }
  }
}
```

### API åˆ†å±‚è°ƒç”¨

```
Composable (useAuth)
    â†“ è°ƒç”¨
API Module (authApi)
    â†“ è°ƒç”¨
Adapter (http)
    â†“ è°ƒç”¨
Platform API (uni.request)
```

---

## ğŸš€ éƒ¨ç½²æ¶æ„ (Deployment Architecture)

### å‰ç«¯éƒ¨ç½²

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         æ„å»ºäº§ç‰© (Build Outputs)        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  H5 ç‰ˆæœ¬         â†’  é™æ€æœåŠ¡å™¨ (Nginx) â”‚
â”‚  å¾®ä¿¡å°ç¨‹åº      â†’  å¾®ä¿¡å¼€å‘è€…å·¥å…·ä¸Šä¼   â”‚
â”‚  æ”¯ä»˜å®å°ç¨‹åº    â†’  æ”¯ä»˜å®å¼€å‘è€…å·¥å…·    â”‚
â”‚  App (æœªæ¥)      â†’  æ‰“åŒ…å‘å¸ƒå•†åº—        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### åç«¯éƒ¨ç½²

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           ç”Ÿäº§ç¯å¢ƒæ¶æ„                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚  Nginx (åå‘ä»£ç†)                      â”‚
â”‚      â†“                                  â”‚
â”‚  NestJS App (PM2 é›†ç¾¤)                 â”‚
â”‚      â†“                                  â”‚
â”‚  PostgreSQL (ä¸»ä»å¤åˆ¶)                 â”‚
â”‚  Redis (ä¸»ä» + Sentinel)               â”‚
â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### CI/CD æµç¨‹

```
ä»£ç æäº¤ (git push)
    â†“
GitHub Actions è§¦å‘
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å‰ç«¯ CI               â”‚
â”‚  - å®‰è£…ä¾èµ–             â”‚
â”‚  - ç±»å‹æ£€æŸ¥             â”‚
â”‚  - è¿è¡Œæµ‹è¯•             â”‚
â”‚  - æ„å»ºé¡¹ç›®             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åç«¯ CI               â”‚
â”‚  - å®‰è£…ä¾èµ–             â”‚
â”‚  - Lint æ£€æŸ¥            â”‚
â”‚  - è¿è¡Œæµ‹è¯•             â”‚
â”‚  - æ„å»ºé¡¹ç›®             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
æµ‹è¯•é€šè¿‡ â†’ è‡ªåŠ¨éƒ¨ç½²åˆ°æµ‹è¯•ç¯å¢ƒ
    â†“
äººå·¥éªŒè¯é€šè¿‡ â†’ éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ
```

---

## ğŸ“Š æŠ€æœ¯æ ˆè¯¦ç»†æ¸…å• (Tech Stack Details)

### å‰ç«¯æŠ€æœ¯æ ˆ

| ç±»åˆ« | æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|:-----|:-----|:-----|:-----|
| **æ¡†æ¶** | Vue 3 | 3.4+ | å“åº”å¼æ¡†æ¶ |
| **è·¨ç«¯** | UniApp | 3.0 alpha | å¤šç«¯ç»Ÿä¸€ |
| **è¯­è¨€** | TypeScript | 5.3+ | ç±»å‹å®‰å…¨ |
| **çŠ¶æ€** | Pinia | 2.1+ | çŠ¶æ€ç®¡ç† |
| **UI åº“** | Wot Design Uni | 1.3+ | ç»„ä»¶åº“ |
| **æ„å»º** | Vite | 5.1+ | æ„å»ºå·¥å…· |
| **æµ‹è¯•** | Vitest | 1.2+ | å•å…ƒæµ‹è¯• |
| **å·¥å…·** | @vue/test-utils | 2.4+ | ç»„ä»¶æµ‹è¯• |

### åç«¯æŠ€æœ¯æ ˆ

| ç±»åˆ« | æŠ€æœ¯ | ç‰ˆæœ¬ | ç”¨é€” |
|:-----|:-----|:-----|:-----|
| **è¿è¡Œæ—¶** | Node.js | 20.x LTS | æœåŠ¡å™¨ç¯å¢ƒ |
| **æ¡†æ¶** | NestJS | 11.x | Web æ¡†æ¶ |
| **è¯­è¨€** | TypeScript | 5.9+ | ç±»å‹å®‰å…¨ |
| **ORM** | Prisma | 5.x+ | æ•°æ®åº“ ORM |
| **æ•°æ®åº“** | PostgreSQL | 16+ | å…³ç³»å‹æ•°æ®åº“ |
| **ç¼“å­˜** | Redis | 7+ | ç¼“å­˜ + é˜Ÿåˆ— |
| **é˜Ÿåˆ—** | BullMQ | - | ä»»åŠ¡é˜Ÿåˆ— |
| **å®æ—¶** | Socket.IO | 4.x | WebSocket |
| **è®¤è¯** | Passport + JWT | - | èº«ä»½è®¤è¯ |
| **æµ‹è¯•** | Jest | 30+ | å•å…ƒæµ‹è¯• |

### DevOps å·¥å…·é“¾

| ç±»åˆ« | å·¥å…· | ç”¨é€” |
|:-----|:-----|:-----|
| **ç‰ˆæœ¬æ§åˆ¶** | Git + GitHub | ä»£ç æ‰˜ç®¡ |
| **åŒ…ç®¡ç†** | pnpm | ä¾èµ–ç®¡ç† |
| **CI/CD** | GitHub Actions | è‡ªåŠ¨åŒ–æµç¨‹ |
| **ä»£ç è´¨é‡** | ESLint + Prettier | ä»£ç è§„èŒƒ |
| **æäº¤è§„èŒƒ** | Commitlint + Husky | Git Hooks |
| **API æ–‡æ¡£** | Swagger | æ¥å£æ–‡æ¡£ |

---

## ğŸ” å®‰å…¨æ¶æ„ (Security Architecture)

### è®¤è¯æµç¨‹

```
ç”¨æˆ·ç™»å½•
    â†“
POST /api/auth/login { phone, code }
    â†“
åç«¯éªŒè¯éªŒè¯ç 
    â†“
ç”Ÿæˆ JWT Token (access + refresh)
    â†“
è¿”å›ç»™å‰ç«¯
    â†“
å‰ç«¯å­˜å‚¨ Token (uni.setStorage)
    â†“
åç»­è¯·æ±‚æºå¸¦ Token (Authorization: Bearer xxx)
    â†“
åç«¯éªŒè¯ Token (PassportGuard)
    â†“
Token è¿‡æœŸ â†’ ä½¿ç”¨ refreshToken åˆ·æ–°
```

### æ•°æ®å®‰å…¨

| å±‚çº§ | æªæ–½ |
|:-----|:-----|
| **ä¼ è¾“å±‚** | HTTPS åŠ å¯† |
| **å­˜å‚¨å±‚** | å¯†ç  bcrypt åŠ å¯†å­˜å‚¨ |
| **è®¿é—®å±‚** | JWT Token è®¤è¯ + æƒé™å®ˆå« |
| **æ•°æ®å±‚** | SQL æ³¨å…¥é˜²æŠ¤ (Prisma ORM) |

---

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–ç­–ç•¥ (Performance Optimization)

### å‰ç«¯ä¼˜åŒ–

1. **ä»£ç åˆ†å‰²**: Vite è‡ªåŠ¨æŒ‰è·¯ç”±åˆ†å‰²ä»£ç 
2. **æ‡’åŠ è½½**: éé¦–å±ç»„ä»¶å»¶è¿ŸåŠ è½½
3. **è™šæ‹Ÿåˆ—è¡¨**: é•¿åˆ—è¡¨ä½¿ç”¨è™šæ‹Ÿæ»šåŠ¨
4. **ç¼“å­˜ç­–ç•¥**:
   - Pinia çŠ¶æ€æŒä¹…åŒ–
   - HTTP è¯·æ±‚ç¼“å­˜ (5 åˆ†é’Ÿå†…é‡å¤è¯·æ±‚è¿”å›ç¼“å­˜)
5. **å›¾ç‰‡ä¼˜åŒ–**:
   - ä½¿ç”¨ WebP æ ¼å¼
   - æ‡’åŠ è½½å›¾ç‰‡
   - CDN åŠ é€Ÿ

### åç«¯ä¼˜åŒ–

1. **æ•°æ®åº“ä¼˜åŒ–**:
   - ç´¢å¼•ä¼˜åŒ– (userId, seatId ç­‰)
   - æŸ¥è¯¢ä¼˜åŒ– (select æŒ‡å®šå­—æ®µ)
   - è¿æ¥æ± ç®¡ç†
2. **ç¼“å­˜ç­–ç•¥**:
   - Redis ç¼“å­˜çƒ­ç‚¹æ•°æ®
   - åº§ä½çŠ¶æ€ç¼“å­˜ (TTL: 30s)
3. **å¼‚æ­¥å¤„ç†**:
   - BullMQ å¤„ç†è€—æ—¶ä»»åŠ¡
   - ç­¾åˆ°é€šçŸ¥å¼‚æ­¥å‘é€
4. **è´Ÿè½½å‡è¡¡**:
   - PM2 é›†ç¾¤æ¨¡å¼
   - Nginx åå‘ä»£ç†

---

## ğŸ“ å¼€å‘è€…æŒ‡å— (Developer Guide)

### è§’è‰²ä¸èŒè´£

| è§’è‰² | èŒè´£ | å·¥å…· |
|:-----|:-----|:-----|
| **Architect** | æ¶æ„è®¾è®¡ã€å¥‘çº¦åˆ¶å®šã€æŠ€æœ¯å†³ç­– | `.claude/contracts/`, `.claude/memory/` |
| **Builder** | åŠŸèƒ½å¼€å‘ã€æµ‹è¯•ç¼–å†™ã€Bug ä¿®å¤ | `frontend/`, `backend/` |
| **Reviewer** | ä»£ç å®¡æŸ¥ã€è´¨é‡æŠŠå…³ | GitHub PR Review |

### å·¥ä½œæµç¨‹

```
Architect åˆ¶å®š PRD/Design Spec
    â†“
Architect åˆ›å»º Ticket
    â†“
Builder é¢†å– Ticket
    â†“
Builder ç¼–å†™æµ‹è¯• (TDD Red)
    â†“
Builder å®ç°åŠŸèƒ½ (TDD Green)
    â†“
Builder é‡æ„ä¼˜åŒ– (TDD Refactor)
    â†“
Builder æäº¤ PR
    â†“
Architect Code Review
    â†“
é€šè¿‡ â†’ åˆå¹¶åˆ°ä¸»åˆ†æ”¯
æœªé€šè¿‡ â†’ ä¿®æ”¹åé‡æ–°æäº¤
```

### å¿…è¯»æ–‡æ¡£

1. `.claude/CLAUDE.md` - AI åä½œå‡†åˆ™
2. `.claude/memory/tech_constraints.md` - æŠ€æœ¯çº¦æŸ
3. `.claude/memory/project_context.md` - é¡¹ç›®ä¸Šä¸‹æ–‡
4. `.claude/contracts/prd.md` - äº§å“éœ€æ±‚
5. `.claude/contracts/design_spec.md` - è®¾è®¡è§„èŒƒ
6. `.github/README.md` - å¼€å‘è§„èŒƒ

---

## ğŸ”„ æŒç»­æ¼”è¿› (Continuous Evolution)

### æ¶æ„æ¼”è¿›è·¯çº¿å›¾

| é˜¶æ®µ | ç›®æ ‡ | å…³é”®æŠ€æœ¯ |
|:-----|:-----|:--------|
| **V1.0 (å½“å‰)** | MVP ä¸Šçº¿ | UniApp + NestJS + PostgreSQL |
| **V1.5** | æ€§èƒ½ä¼˜åŒ– | Redis ç¼“å­˜ + CDN + ä»£ç åˆ†å‰² |
| **V2.0** | åŠŸèƒ½æ‰©å±• | WebSocket å®æ—¶é€šä¿¡ + æ”¯ä»˜é›†æˆ |
| **V2.5** | æ•°æ®æ™ºèƒ½ | ç”¨æˆ·è¡Œä¸ºåˆ†æ + æ¨èç®—æ³• |
| **V3.0** | å¹³å°åŒ– | å¼€æ”¾ API + ç¬¬ä¸‰æ–¹é›†æˆ |

### æ¶æ„ä¼˜åŒ–è®¡åˆ’

1. **çŸ­æœŸ (1-3 ä¸ªæœˆ)**:
   - å®Œå–„æµ‹è¯•è¦†ç›–ç‡ â†’ 80%+
   - è¡¥å…… E2E æµ‹è¯•
   - æ€§èƒ½ç›‘æ§æ¥å…¥

2. **ä¸­æœŸ (3-6 ä¸ªæœˆ)**:
   - å¼•å…¥ GraphQL (æ›¿ä»£éƒ¨åˆ† REST API)
   - å®ç°å‰ç«¯å¾®å‰ç«¯æ¶æ„ (qiankun)
   - åç«¯å¾®æœåŠ¡æ‹†åˆ†

3. **é•¿æœŸ (6-12 ä¸ªæœˆ)**:
   - Serverless åŒ–æ”¹é€ 
   - AI åŠŸèƒ½é›†æˆ (å­¦ä¹ æ¨è)
   - å›½é™…åŒ–æ”¯æŒ

---

## ğŸ“ æ¶æ„å†³ç­–è®°å½• (ADR - Architecture Decision Records)

### ADR-001: é€‰æ‹© Monorepo æ¶æ„

**æ—¥æœŸ**: 2026-01-23
**çŠ¶æ€**: âœ… å·²é‡‡çº³

**èƒŒæ™¯**: éœ€è¦åœ¨å¤šä¸ªå‰ç«¯å¹³å°å…±äº«ä¸šåŠ¡é€»è¾‘

**å†³ç­–**: é‡‡ç”¨ Monorepo + "æ¥å£å³å›´æ " æ¨¡å¼

**ç†ç”±**:
- âœ… é€»è¾‘å¤ç”¨ï¼šCore å±‚ä»£ç å¯åœ¨å¤šä¸ªå¹³å°ä½¿ç”¨
- âœ… ç±»å‹å®‰å…¨ï¼šTypeScript ç»Ÿä¸€ç±»å‹å®šä¹‰
- âœ… æµ‹è¯•éš”ç¦»ï¼šCore å±‚å¯åœ¨ Node.js ç¯å¢ƒæµ‹è¯•
- âœ… ä¾èµ–æ¸…æ™°ï¼šé€šè¿‡æ¥å£å¼ºåˆ¶è§£è€¦

**åæœ**:
- éœ€è¦ç»´æŠ¤é€‚é…å™¨æ¥å£
- å­¦ä¹ æ›²çº¿ç•¥é™¡

---

### ADR-002: é€‰æ‹© Pinia è€Œé Vuex

**æ—¥æœŸ**: 2026-01-23
**çŠ¶æ€**: âœ… å·²é‡‡çº³

**èƒŒæ™¯**: Vue 3 çŠ¶æ€ç®¡ç†æ–¹æ¡ˆé€‰å‹

**å†³ç­–**: ä½¿ç”¨ Pinia

**ç†ç”±**:
- âœ… å®˜æ–¹æ¨èï¼ˆVuex 5 å³ Piniaï¼‰
- âœ… Composition API å‹å¥½
- âœ… TypeScript æ”¯æŒæ›´å¥½
- âœ… æ›´è½»é‡ã€API æ›´ç®€æ´

**åæœ**:
- æ— éœ€ mutationsï¼Œç›´æ¥ä¿®æ”¹ state
- æ›´å°‘æ ·æ¿ä»£ç 

---

### ADR-003: TDD å¼ºåˆ¶æµç¨‹

**æ—¥æœŸ**: 2026-01-23
**çŠ¶æ€**: âœ… å·²é‡‡çº³

**èƒŒæ™¯**: ç¡®ä¿ä»£ç è´¨é‡

**å†³ç­–**: æ‰€æœ‰ä¸šåŠ¡é€»è¾‘å¿…é¡»å…ˆå†™æµ‹è¯•

**ç†ç”±**:
- âœ… æé«˜ä»£ç è´¨é‡
- âœ… é‡æ„å®‰å…¨ç½‘
- âœ… æ–‡æ¡£åŒ–ä½œç”¨

**åæœ**:
- å¼€å‘é€Ÿåº¦åˆæœŸè¾ƒæ…¢
- éœ€è¦é…ç½®å®Œå–„çš„æµ‹è¯•ç¯å¢ƒ

---

## ğŸ¯ æ€»ç»“

ZenSpace é‡‡ç”¨çš„æ˜¯ä¸€å¥— **ç°ä»£åŒ–ã€å·¥ç¨‹åŒ–ã€å¯ç»´æŠ¤** çš„å‰åç«¯åˆ†ç¦»æ¶æ„ï¼š

âœ… **å‰ç«¯**: Monorepo + æ¥å£å›´æ  + TDD
âœ… **åç«¯**: NestJS + Prisma + å¾®æœåŠ¡
âœ… **åä½œ**: å¥‘çº¦å¼å¼€å‘ + AI è¾…åŠ©
âœ… **è´¨é‡**: å…¨é“¾è·¯æµ‹è¯• + CI/CD

**æ ¸å¿ƒç†å¿µ**: è®©æ¶æ„ä¸ºä¸šåŠ¡æœåŠ¡ï¼Œè€ŒéæŸç¼šä¸šåŠ¡å‘å±•ã€‚

---

**æ–‡æ¡£ç»´æŠ¤è€…**: Architect
**æœ€åæ›´æ–°**: 2026-01-24
**ä¸‹æ¬¡å®¡æŸ¥**: 2026-02-24

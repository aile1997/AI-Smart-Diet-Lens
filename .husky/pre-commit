#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh""

echo "ğŸ” è¿è¡Œ pre-commit æ£€æŸ¥..."

# é›¶æ±¡æŸ“æ£€æŸ¥ï¼ˆæ’é™¤é€‚é…å™¨å±‚å’Œå·¥å…·å±‚ï¼‰
echo ""
echo "æ£€æŸ¥å¹³å° API æ³„éœ²..."

# æ’é™¤: adaptersã€utilsã€client.tsã€useRouteGuard.ts
UNI_CALLS=$(grep -r "^\s*uni\." \
  frontend/packages/core/src/composables/ \
  frontend/packages/core/src/api/services/ \
  --include="*.ts" 2>/dev/null | \
  grep -v "useRouteGuard.ts" || true)

if [ -n "$UNI_CALLS" ]; then
  echo "âŒ é”™è¯¯: Core å±‚å‘ç° uni.xxx è°ƒç”¨!"
  echo "$UNI_CALLS"
  echo "Core å±‚ä¸¥ç¦ä½¿ç”¨å¹³å°ç‰¹å®š APIï¼Œè¯·é€šè¿‡ adapters æ¥å£è¿›è¡ŒæŠ½è±¡ã€‚"
  exit 1
fi

echo "âœ… é›¶æ±¡æŸ“æ£€æŸ¥é€šè¿‡"

echo ""
echo "ğŸ‰ Pre-commit æ£€æŸ¥é€šè¿‡!"
